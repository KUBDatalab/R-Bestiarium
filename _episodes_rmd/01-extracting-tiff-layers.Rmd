---
title: "Extracting tiff-layers"
teaching: 0
exercises: 0
questions:
- "Hvordan ekstraherer jeg lag fra en geotiff fil?"
objectives:
- "FIXME"
keypoints:
- "FIXME"
---

```{r SETUP, include = FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("01-")
```


```{r terra, include = FALSE}
install.packages("proj4")
library(proj4)
install.packages("rgdal")
library(rgdal)
install.packages("terra")
library(terra)
```


```{r sp, include = FALSE}
install.packages("sp")
library(sp)
```


```{r raster, include = FALSE}
install.packages("raster")
library(raster)

```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Tiff-filer kan indeholde lag. Vi er stødt på dem i en situation hvor
en studerende havde behov for at trække lagene ud af en 
GeoTIFF fil. 

Her er et eksempel på en tiff-fil med tre lag:

![Trelagstiff](fig/stacked_tiff.tif)


Den kan vi indlæse:

```{r}
tif <- stack("fig/stacked_tiff.tif")
```
Der er tre lag:
```{r}
raster::nlayers(tif)
```
De har navne:
```{r}
names(tif)
```
Og vi kan plotte dem individuelt:

```{r}
plot(tif$layer.1)
```
```{r}
plot(tif$layer.2)
```
```{r}
plot(tif$layer.3)
```

Vi kan også gemme dem individuelt:
```{r, eval = F}
writeRaster(tif$layer.3, "filnavn.tif")
```

## Noter

Filen er grabset fra biblioteket `plainview`, mere specifikt er det et udsnit af
sattelitfotos fra Landsat 8, omkring byen Poppendorf, lidt til højre for Rostock.

Husk også at ikke alle TIFF filer har lag. Så hvis du kun kan trække et enkelt lag ud, så kan det skyldes at der kun er et.

De her lagdelte TIFF filer bruges ofte  til at gennem forskellige "kanaler" i billedet.

Det kan være en kanal med landskabet set i IR-spektret. Eller tre kanaler med hver af farverne rød, grøn og blå. Vælger man kun at kigge på det grønne lag, kan det være lettere at identificere hvor vegetationen er.

{% include links.md %}